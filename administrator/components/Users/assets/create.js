"use strict";

$(document).ready(function () {
    $('#users_create [button-submit]').ajaxSubmit({
        url: 'index.php/users/create_user',
        typeSend: 'click',
        formSubmit: $('form[name="users_create"]'),
        textReDrawButton: true,
        onError: function (response) {
            alertify.error(response.message);
        },
        success: function (response) {
            swal({
                text: 'Se agregó el usuario.',
                type: 'success',
                showLoaderOnConfirm: true,
                allowOutsideClick: false,
                preConfirm: function () {
                    return new Promise(function (resolve) {
                        window.location.href = response.redirect;

                        setTimeout(function () {
                            resolve();
                        }, 5000);
                    });
                }
            });
        }
    });

    $('form[name="create_permission"]').ajaxSubmit({
        url: 'index.php/users/create_permission',
        textReDrawButton: true,
        onError: function (response) {
            alertify.error(response.message);
        },
        success: function (response) {
            swal({
                text: 'Se agregó el permiso.',
                type: 'success',
                showLoaderOnConfirm: true,
                allowOutsideClick: false,
                preConfirm: function () {
                    return new Promise(function (resolve) {
                        window.location.href = response.redirect;

                        setTimeout(function () {
                            resolve();
                        }, 5000);
                    });
                }
            });
        }
    });
});
